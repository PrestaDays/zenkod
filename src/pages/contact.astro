---
import BaseLayout from "../layouts/BaseLayout.astro";
import FormButton from "../components/FormButton";

const pageTitle = "Contact Page";
---

<BaseLayout pageTitle={pageTitle}>
    <div class="bg-[#F2E8CF] w-full py-8 md:py-16 px-4">
        <h1 class="text-center text-3xl md:text-4xl lg:text-5xl font-bold">Nous Contacter</h1>
        <p class="text-center mt-4 md:mt-8 text-base md:text-lg px-4 max-w-3xl mx-auto">
            Vous souhaitez <span class="text-[#D57A66]">réaliser votre site web</span> mais n'avez pas le temps de le
            coder de zéro ? <br class="hidden md:block"/>
            Contactez-nous et nous ferons le site de vos rêves.
        </p>
    </div>

    <div class="my-4 md:my-8"></div>

    <div class="flex justify-center items-center px-4 md:px-6">
        <form
                id="contact-form"
                class="bg-[#4A6670] p-4 md:p-8 rounded-lg w-full max-w-4xl mb-12 md:mb-20 transform transition duration-700 hover:scale-[1.02] animate-fade-in"
        >
            {/* Nom et Prénom */}
            <div class="flex flex-col md:flex-row md:space-x-8 mb-4 animate-slide-in">
                <div class="w-full md:w-1/2 mb-4 md:mb-0">
                    <label class="text-white transition-all duration-300 hover:text-gray-200 block mb-1">Nom :</label>
                    <input
                            type="text"
                            name="nom"
                            placeholder="Votre nom"
                            class="w-full p-2 rounded transition-all duration-300 focus:ring-2 focus:ring-blue-400 focus:scale-105 hover:shadow-lg"
                            required
                    />
                </div>
                <div class="w-full md:w-1/2">
                    <label class="text-white transition-all duration-300 hover:text-gray-200 block mb-1">Prénom
                        :</label>
                    <input
                            type="text"
                            name="prenom"
                            placeholder="Votre prénom"
                            class="w-full p-2 rounded transition-all duration-300 focus:ring-2 focus:ring-blue-400 focus:scale-105 hover:shadow-lg"
                            required
                    />
                </div>
            </div>

            {/* Projet et Email */}
            <div class="flex flex-col md:flex-row md:space-x-8 mb-4 animate-slide-in" style="animation-delay: 200ms;">
                <div class="w-full md:w-1/2 mb-4 md:mb-0">
                    <label class="text-white transition-all duration-300 hover:text-gray-200 block mb-1">
                        Nom projet/entreprise :
                    </label>
                    <input
                            type="text"
                            name="projet"
                            placeholder="Nom de votre projet/entreprise"
                            class="w-full p-2 rounded transition-all duration-300 focus:ring-2 focus:ring-blue-400 focus:scale-105 hover:shadow-lg"
                            required
                    />
                </div>
                <div class="w-full md:w-1/2">
                    <label class="text-white transition-all duration-300 hover:text-gray-200 block mb-1">Email :</label>
                    <input
                            type="email"
                            name="email"
                            placeholder="Votre email"
                            class="w-full p-2 rounded transition-all duration-300 focus:ring-2 focus:ring-blue-400 focus:scale-105 hover:shadow-lg"
                            required
                    />
                </div>
            </div>

            {/* Message */}
            <div class="mb-4 animate-slide-in" style="animation-delay: 400ms;">
                <label class="text-white transition-all duration-300 hover:text-gray-200 block mb-1">Message :</label>
                <textarea
                        name="message"
                        rows="5"
                        placeholder="Votre message"
                        class="w-full p-2 rounded transition-all duration-300 focus:ring-2 focus:ring-blue-400 focus:scale-105 hover:shadow-lg"
                        required
                ></textarea>
            </div>

            <div class="flex justify-center animate-bounce-in" style="animation-delay: 600ms;">
                <FormButton label="Envoyer" type="submit"/>
            </div>
        </form>
    </div>

    {/* Popup */}
    <div id="popup-overlay"
         class="hidden fixed inset-0 bg-black bg-opacity-50 backdrop-blur-md flex justify-center items-center z-50">
        <div class="bg-white p-4 md:p-8 rounded-md shadow-md w-[90%] max-w-sm md:w-96 m-4">
            <h2 id="popup-message" class="text-lg md:text-xl font-semibold text-center"></h2>
            <div class="mt-4 text-center">
                <button id="popup-close"
                        class="bg-[#D57A66] text-white px-4 py-2 rounded hover:bg-[#c56e5b] transition-colors">
                    Fermer
                </button>
            </div>
        </div>
    </div>

    <style>
        @keyframes fade-in {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }

        @keyframes slide-in {
            from {
                transform: translateY(20px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        @keyframes bounce-in {
            0% {
                transform: scale(0);
                opacity: 0;
            }
            50% {
                transform: scale(1.2);
            }
            100% {
                transform: scale(1);
                opacity: 1;
            }
        }

        .animate-fade-in {
            animation: fade-in 1s ease-out;
        }

        .animate-slide-in {
            animation: slide-in 0.8s ease-out forwards;
            opacity: 0;
        }

        .animate-bounce-in {
            animation: bounce-in 0.8s cubic-bezier(0.68, -0.55, 0.265, 1.55) forwards;
            opacity: 0;
        }
    </style>

    <script
            type="text/javascript"
            src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"
    >
        (function () {
            emailjs.init("mK4gf-7vVImGgewy6");
        })();

        window.onload = function () {
            document
                .getElementById("contact-form")
                .addEventListener("submit", function (event) {
                    event.preventDefault();
                    emailjs.sendForm("service_zspxt3n", "template_nuc5iss", this).then(
                        () => {
                            showPopup("Message envoyé avec succès !");
                        },
                        (error) => {
                            showPopup("Échec de l'envoi. Veuillez réessayer.");
                            console.error("ERROR : ", error);
                        }
                    );
                });

            function showPopup(message) {
                document.getElementById("popup-message").textContent = message;
                const popupOverlay = document.getElementById("popup-overlay");
                popupOverlay.classList.remove("hidden");
                popupOverlay.classList.add("show");

                document
                    .getElementById("popup-close")
                    .addEventListener("click", function () {
                        Redirect();
                    });
            }

            function Redirect() {
                window.location.href = "/";
            }
        };
    </script>
</BaseLayout>